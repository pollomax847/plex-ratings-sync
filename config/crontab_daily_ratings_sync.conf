# Configuration cron pour la synchronisation QUOTIDIENNE des ratings Plex
# À installer avec : crontab -e

# ============================================
# SYNCHRONISATION QUOTIDIENNE PLEX RATINGS
# ============================================

# Synchronisation chaque soir à 22h (10 PM)
# - Récupère les nouvelles évaluations (étoiles) de PlexAmp/Plex
# - Supprime les fichiers marqués avec 1 étoile
# - Met à jour les métadonnées ID3 des fichiers avec ratings
0 22 * * * /home/paulceline/bin/audio/plex/plex_daily_ratings_sync.sh >> /home/paulceline/logs/plex_ratings/daily.log 2>&1

# Alternative : synchronisation plus tôt dans la soirée (20h / 8 PM)
# 0 20 * * * /home/paulceline/bin/audio/plex/plex_daily_ratings_sync.sh >> /home/paulceline/logs/plex_ratings/daily.log 2>&1

# Alternative : synchronisation tard le soir (23h30 / 11:30 PM)
# 30 23 * * * /home/paulceline/bin/audio/plex/plex_daily_ratings_sync.sh >> /home/paulceline/logs/plex_ratings/daily.log 2>&1

# ============================================
# NETTOYAGE HEBDOMADAIRE DES LOGS
# ============================================

# Archivage des logs plus vieux que 30 jours (chaque dimanche à 3h du matin)
0 3 * * 0 find /home/paulceline/logs/plex_ratings -name "*.log" -mtime +30 -delete

# ============================================
# RAPPORT HEBDOMADAIRE (OPTIONNEL)
# ============================================

# Génération d'un rapport de synchronisation hebdomadaire (dimanche à 23h)
# 0 23 * * 0 /home/paulceline/bin/audio/plex/plex_daily_ratings_sync.sh --stats >> /home/paulceline/logs/plex_ratings/weekly_report.log 2>&1

# ============================================
# INSTALLATION SIMPLE
# ============================================

# Pour installer UNIQUEMENT la synchronisation quotidienne :
# 1. crontab -e
# 2. Copier cette ligne :
#    0 22 * * * /home/paulceline/bin/audio/plex/plex_daily_ratings_sync.sh >> /home/paulceline/logs/plex_ratings/daily.log 2>&1
# 3. Sauvegarder (Ctrl+X puis Y)
# 4. Vérifier : crontab -l

# ============================================
# COMMANDES UTILES
# ============================================

# Voir les logs de synchronisation :
# tail -f /home/paulceline/logs/plex_ratings/daily.log

# Voir toutes les entrées cron :
# crontab -l

# Exécuter manuellement le script :
# /home/paulceline/bin/audio/plex/plex_daily_ratings_sync.sh

# Voir les dernières synchronisations :
# ls -lht /home/paulceline/logs/plex_ratings/
